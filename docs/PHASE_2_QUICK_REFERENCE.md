# ğŸš€ Phase 2 åŠ¨æ€é…é€è´¹ - å¿«é€Ÿå‚è€ƒ

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½

âœ… **åŠ¨æ€é…é€è´¹è®¡ç®—** - åŸºäºè·ç¦»ã€æ—¶é—´ã€å¤©æ°”  
âœ… **æ™ºèƒ½ ETA ä¼°ç®—** - 20 km/h å¹³å‡é€Ÿåº¦  
âœ… **å¤©æ°”æ„ŸçŸ¥å®šä»·** - æ¶åŠ£å¤©æ°” 1.2x åŠ ä»·  
âœ… **é«˜å³°æœŸå®šä»·** - åˆé¤/æ™šé¤æ—¶æ®µ 1.5x åŠ ä»·  
âœ… **è·ç¦»é€æ˜åŒ–** - æ˜¾ç¤ºå®é™…é…é€è·ç¦»  

---

## ğŸ’° å®šä»·å…¬å¼

```
é…é€è´¹ = (åŸºç¡€è´¹ $3.00 + è·ç¦» Ã— $1.50/km) Ã— é«˜å³°æœŸç³»æ•° Ã— å¤©æ°”ç³»æ•°
æœ€ä½é…é€è´¹ = $2.00
```

**ç³»æ•°è¡¨:**
- é«˜å³°æœŸ (11-13, 17-20): **1.5x**
- æ¶åŠ£å¤©æ°”: **1.2x**
- æ™®é€šæ—¶æ®µ: **1.0x**

---

## ğŸ“Š ç¤ºä¾‹è®¡ç®—

| è·ç¦» | æ—¶é—´ | å¤©æ°” | åŸºç¡€è´¹ | é«˜å³°åŠ ä»· | å¤©æ°”åŠ ä»· | **æœ€ç»ˆè´¹ç”¨** |
|------|------|------|--------|----------|----------|--------------|
| 3km  | 15:00 | æ­£å¸¸ | $7.50  | -        | -        | **$7.50**    |
| 5km  | 12:00 | æ­£å¸¸ | $10.50 | +$5.25   | -        | **$15.75**   |
| 2km  | 18:30 | æš´é›¨ | $6.00  | +$3.00   | +$1.80   | **$10.80**   |

---

## ğŸ”§ æ–°å¢ API å­—æ®µ

**è®¢å•å“åº” (OrderDTO):**

```json
{
  "deliveryFee": 10.80,           // åŠ¨æ€è®¡ç®—çš„é…é€è´¹
  "deliveryDistanceKm": 2.35,     // é…é€è·ç¦»
  "weatherCondition": "æš´é›¨",      // å¤©æ°”æè¿°
  "badWeatherSurcharge": true,    // æ¶åŠ£å¤©æ°”æ ‡è®°
  "peakHourSurcharge": true,      // é«˜å³°æœŸæ ‡è®°
  "estimatedDelivery": "18:46:00" // åŠ¨æ€ ETA
}
```

---

## ğŸ§ª å¿«é€Ÿæµ‹è¯•

**åˆ›å»ºè®¢å•:**

```bash
curl -X POST http://localhost:8080/api/orders \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "restaurantId": 1,
    "deliveryAddressId": 1,
    "items": [{"menuItemId": 1, "quantity": 2}],
    "paymentMethod": "CREDIT_CARD"
  }'
```

**æŸ¥çœ‹æ—¥å¿—:**

```bash
docker logs doordash-app | grep "åŠ¨æ€é…é€è´¹"
```

---

## ğŸ“ ä¿®æ”¹çš„æ–‡ä»¶

1. `Order.java` - æ–°å¢ 4 ä¸ªå­—æ®µ
2. `OrderDTO.java` - æ–°å¢ 4 ä¸ªå­—æ®µ
3. `OrderService.java` - é›†æˆåŠ¨æ€è®¡ç®—
4. `DeliveryFeeCalculator.java` - å…¬å¼€ isPeakHour()
5. `WeatherService.java` - **æ–°å»º**å¤©æ°”æœåŠ¡

---

## âš¡ æ€§èƒ½ä¼˜åŒ–

- Haversine è·ç¦»è®¡ç®—: **O(1)**
- å¤©æ°”æ£€æµ‹: **O(1)** (æ¨¡æ‹Ÿ)
- é…é€è´¹è®¡ç®—: **O(1)**
- **æ— é¢å¤–æ•°æ®åº“æŸ¥è¯¢**

---

## ğŸ“ˆ Phase 1 â†’ Phase 2 å¯¹æ¯”

| åŠŸèƒ½ | Phase 1 | Phase 2 |
|------|---------|---------|
| é…é€è´¹ | å›ºå®š $5 | åŠ¨æ€ $3-$20+ |
| ETA | å›ºå®š 45 åˆ†é’Ÿ | åŠ¨æ€ 10-60 åˆ†é’Ÿ |
| è·ç¦»æ˜¾ç¤º | âŒ | âœ… |
| å¤©æ°”è€ƒè™‘ | âŒ | âœ… |
| é«˜å³°æœŸå®šä»· | âŒ | âœ… |

---

**æ›´æ–°æ—¶é—´:** 2026-01-21  
**çŠ¶æ€:** âœ… ç”Ÿäº§å°±ç»ª
